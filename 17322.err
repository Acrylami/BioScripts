Loading snippy/v4.6.0
  Loading requirement: bioperl-live/release-1-7-2
[20:50:18] This is snippy 4.6.0
[20:50:18] Written by Torsten Seemann
[20:50:18] Obtained from https://github.com/tseemann/snippy
[20:50:18] Detected operating system: linux
[20:50:18] Enabling bundled linux tools.
[20:50:18] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:50:18] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:50:18] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:50:18] Found java - /usr/bin/java
[20:50:18] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:50:18] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:50:18] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:50:18] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:50:18] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:50:18] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:50:18] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:50:18] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:50:18] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:50:18] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:50:18] Found gzip - /usr/bin/gzip
[20:50:18] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:50:18] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:50:18] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:50:18] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:50:18] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:50:18] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:50:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:50:19] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:50:19] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:50:19] Treating reference as 'fasta' format.
[20:50:19] Will use 8 CPU cores.
[20:50:19] Using read file: /mnt/scratch/c1803625/trimming/SRR13297086_1_trim.fastq.gz
[20:50:19] Using read file: /mnt/scratch/c1803625/trimming/SRR13297086_2_trim.fastq.gz
[20:50:19] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297086
[20:50:19] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297086
[20:50:19] Creating reference folder: reference
[20:50:19] Extracting FASTA and GFF from reference.
[20:50:19] Wrote 1 sequences to ref.fa
[20:50:19] Wrote 0 features to ref.gff
[20:50:19] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:50:19] Using BAM RG (Read Group) ID: snip_SRR13297086
[20:50:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:50:19] Running: bwa index reference/ref.fa 2>> snps.log
[20:50:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:50:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:50:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:50:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:50:19] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297086\tSM:snip_SRR13297086' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297086_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297086_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 546158 sequences (73213768 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (1, 254860, 8, 7)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (73, 118, 178)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 388)
[M::mem_pestat] mean and std.dev: (132.73, 76.73)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 493)
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 546158 reads in 39.429 CPU sec, 5.071 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 547038, removed 52280, allowed 3342, passed 494758
[main] CMD:[samclip] Header contained 3 lines
 bwa[samclip] Done.
 mem -Y -M -R @RG\tID:snip_SRR13297086\tSM:snip_SRR13297086 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297086_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297086_2_trim.fastq.gz
[main] Real time: 9.147 sec; CPU: 41.478 sec
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:50:32] Running: samtools index snps.bam 2>> snps.log
[20:50:33] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:50:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:50:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 6
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:50:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:50:37] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:50:37] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:50:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:50:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:50:37] Running: bcftools consensus --sample snip_SRR13297086 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:50:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:50:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:50:37] Running: bcftools consensus --sample snip_SRR13297086 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:50:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:50:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:50:39] Marked 44 heterozygous sites with 'n'
[20:50:39] Creating extra output files: BED GFF CSV TXT HTML
[20:50:39] Identified 6 variants.
[20:50:39] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297086
[20:50:39] Result files:
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.aligned.fa
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.bam
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.bam.bai
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.bed
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.consensus.fa
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.consensus.subs.fa
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.csv
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.filt.vcf
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.gff
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.html
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.log
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.raw.vcf
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.subs.vcf
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.tab
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.txt
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.vcf
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.vcf.gz
[20:50:39] * /mnt/scratch/c1803625/snippy/snip_SRR13297086/snps.vcf.gz.csi
[20:50:39] Walltime used: 21 seconds
[20:50:39] May the SNPs be with you.
[20:50:39] Done.
[20:50:39] This is snippy 4.6.0
[20:50:39] Written by Torsten Seemann
[20:50:39] Obtained from https://github.com/tseemann/snippy
[20:50:39] Detected operating system: linux
[20:50:39] Enabling bundled linux tools.
[20:50:39] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:50:39] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:50:39] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:50:39] Found java - /usr/bin/java
[20:50:39] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:50:39] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:50:39] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:50:39] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:50:39] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:50:39] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:50:39] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:50:39] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:50:39] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:50:39] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:50:39] Found gzip - /usr/bin/gzip
[20:50:39] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:50:39] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:50:39] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:50:39] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:50:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:50:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:50:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:50:40] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:50:40] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:50:40] Treating reference as 'fasta' format.
[20:50:40] Will use 8 CPU cores.
[20:50:40] Using read file: /mnt/scratch/c1803625/trimming/SRR13297087_1_trim.fastq.gz
[20:50:40] Using read file: /mnt/scratch/c1803625/trimming/SRR13297087_2_trim.fastq.gz
[20:50:40] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297087
[20:50:40] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297087
[20:50:40] Creating reference folder: reference
[20:50:40] Extracting FASTA and GFF from reference.
[20:50:40] Wrote 1 sequences to ref.fa
[20:50:40] Wrote 0 features to ref.gff
[20:50:40] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:50:40] Using BAM RG (Read Group) ID: snip_SRR13297087
[20:50:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:50:40] Running: bwa index reference/ref.fa 2>> snps.log
[20:50:40] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:50:40] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:50:40] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:50:40] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:50:40] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297087\tSM:snip_SRR13297087' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297087_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297087_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 280736 sequences (38924862 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (3, 133269, 3, 5)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (76, 124, 184)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 400)
[M::mem_pestat] mean and std.dev: (136.99, 78.01)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 508)
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 280736 reads in 21.480 CPU sec, 2.761 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297087\tSM:snip_SRR13297087 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297087_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297087_2_trim.fastq.gz[samclip] Total SAM records 281597, removed 28955, allowed 2328, passed 252642

[main] Real time: 4.856 sec; CPU: 22.495 sec
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:50:47] Running: samtools index snps.bam 2>> snps.log
[20:50:47] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:50:47] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:50:50] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 10
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:50:50] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:50:50] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:50:50] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:50:50] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:50:50] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:50:50] Running: bcftools consensus --sample snip_SRR13297087 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:50:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:50:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:50:50] Running: bcftools consensus --sample snip_SRR13297087 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:50:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:50:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:50:51] Marked 63 heterozygous sites with 'n'
[20:50:51] Creating extra output files: BED GFF CSV TXT HTML
[20:50:51] Identified 10 variants.
[20:50:51] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297087
[20:50:51] Result files:
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.aligned.fa
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.bam
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.bam.bai
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.bed
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.consensus.fa
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.consensus.subs.fa
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.csv
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.filt.vcf
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.gff
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.html
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.log
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.raw.vcf
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.subs.vcf
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.tab
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.txt
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.vcf
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.vcf.gz
[20:50:51] * /mnt/scratch/c1803625/snippy/snip_SRR13297087/snps.vcf.gz.csi
[20:50:51] Walltime used: 12 seconds
[20:50:51] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[20:50:51] Done.
[20:50:51] This is snippy 4.6.0
[20:50:51] Written by Torsten Seemann
[20:50:51] Obtained from https://github.com/tseemann/snippy
[20:50:51] Detected operating system: linux
[20:50:51] Enabling bundled linux tools.
[20:50:51] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:50:51] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:50:51] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:50:51] Found java - /usr/bin/java
[20:50:51] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:50:51] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:50:51] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:50:51] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:50:51] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:50:51] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:50:51] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:50:51] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:50:51] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:50:51] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:50:51] Found gzip - /usr/bin/gzip
[20:50:51] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:50:51] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:50:51] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:50:51] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:50:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:50:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:50:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:50:52] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:50:52] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:50:52] Treating reference as 'fasta' format.
[20:50:52] Will use 8 CPU cores.
[20:50:52] Using read file: /mnt/scratch/c1803625/trimming/SRR13297088_1_trim.fastq.gz
[20:50:52] Using read file: /mnt/scratch/c1803625/trimming/SRR13297088_2_trim.fastq.gz
[20:50:52] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297088
[20:50:52] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297088
[20:50:52] Creating reference folder: reference
[20:50:52] Extracting FASTA and GFF from reference.
[20:50:52] Wrote 1 sequences to ref.fa
[20:50:52] Wrote 0 features to ref.gff
[20:50:52] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:50:52] Using BAM RG (Read Group) ID: snip_SRR13297088
[20:50:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:50:52] Running: bwa index reference/ref.fa 2>> snps.log
[20:50:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:50:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:50:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:50:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:50:52] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297088\tSM:snip_SRR13297088' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297088_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297088_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 419302 sequences (55857606 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (5, 193610, 4, 1)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (71, 116, 176)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 386)
[M::mem_pestat] mean and std.dev: (130.84, 76.70)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 491)
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 419302 reads in 31.097 CPU sec, 3.997 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297088\tSM:snip_SRR13297088 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297088_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297088_2_trim.fastq.gz
[main] Real time: 7.147 sec; CPU: 32.639 sec
[samclip] Total SAM records 419933, removed 45571, allowed 2488, passed 374362
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:51:02] Running: samtools index snps.bam 2>> snps.log
[20:51:03] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:51:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:51:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 10
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:51:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:51:06] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:51:06] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:51:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:51:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:51:06] Running: bcftools consensus --sample snip_SRR13297088 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:51:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:51:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:51:06] Running: bcftools consensus --sample snip_SRR13297088 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:51:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:51:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:51:08] Marked 49 heterozygous sites with 'n'
[20:51:08] Creating extra output files: BED GFF CSV TXT HTML
[20:51:08] Identified 10 variants.
[20:51:08] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297088
[20:51:08] Result files:
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.aligned.fa
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.bam
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.bam.bai
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.bed
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.consensus.fa
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.consensus.subs.fa
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.csv
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.filt.vcf
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.gff
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.html
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.log
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.raw.vcf
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.subs.vcf
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.tab
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.txt
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.vcf
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.vcf.gz
[20:51:08] * /mnt/scratch/c1803625/snippy/snip_SRR13297088/snps.vcf.gz.csi
[20:51:08] Walltime used: 17 seconds
[20:51:08] Questionable SNP? Try the --report option to see the alignments.
[20:51:08] Done.
[20:51:08] This is snippy 4.6.0
[20:51:08] Written by Torsten Seemann
[20:51:08] Obtained from https://github.com/tseemann/snippy
[20:51:08] Detected operating system: linux
[20:51:08] Enabling bundled linux tools.
[20:51:08] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:51:08] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:51:08] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:51:08] Found java - /usr/bin/java
[20:51:08] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:51:08] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:51:08] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:51:08] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:51:08] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:51:08] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:51:08] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:51:08] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:51:08] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:51:08] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:51:08] Found gzip - /usr/bin/gzip
[20:51:08] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:51:08] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:51:08] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:51:08] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:51:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:51:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:51:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:51:08] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:51:08] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:51:08] Treating reference as 'fasta' format.
[20:51:08] Will use 8 CPU cores.
[20:51:08] Using read file: /mnt/scratch/c1803625/trimming/SRR13297089_1_trim.fastq.gz
[20:51:08] Using read file: /mnt/scratch/c1803625/trimming/SRR13297089_2_trim.fastq.gz
[20:51:08] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297089
[20:51:08] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297089
[20:51:08] Creating reference folder: reference
[20:51:08] Extracting FASTA and GFF from reference.
[20:51:08] Wrote 1 sequences to ref.fa
[20:51:08] Wrote 0 features to ref.gff
[20:51:08] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:51:08] Using BAM RG (Read Group) ID: snip_SRR13297089
[20:51:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:51:08] Running: bwa index reference/ref.fa 2>> snps.log
[20:51:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:51:08] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:51:08] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:51:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:51:08] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297089\tSM:snip_SRR13297089' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297089_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297089_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 429938 sequences (61274763 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (2, 204735, 17, 12)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (82, 128, 189)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 403)
[M::mem_pestat] mean and std.dev: (142.05, 77.33)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 510)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (1012, 1684, 4715)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 12121)
[M::mem_pestat] mean and std.dev: (2812.47, 2906.70)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 15824)
[M::mem_pestat] analyzing insert size distribution for orientation RR...
[M::mem_pestat] (25, 50, 75) percentile: (475, 558, 6202)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 17656)
[M::mem_pestat] mean and std.dev: (2315.33, 3093.53)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 23383)
[M::mem_pestat] skip orientation RF
[M::mem_pestat] skip orientation RR
[M::mem_process_seqs] Processed 429938 reads in 33.725 CPU sec, 4.332 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297089\tSM:snip_SRR13297089 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297089_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297089_2_trim.fastq.gz
[main] Real time: 7.565 sec; CPU: 35.403 sec
[samclip] Total SAM records 431484, removed 29875, allowed 4058, passed 401609
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:51:20] Running: samtools index snps.bam 2>> snps.log
[20:51:20] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:51:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:51:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 5
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:51:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:51:24] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:51:24] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:51:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:51:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:51:24] Running: bcftools consensus --sample snip_SRR13297089 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:51:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:51:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:51:24] Running: bcftools consensus --sample snip_SRR13297089 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:51:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:51:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:51:26] Marked 35 heterozygous sites with 'n'
[20:51:26] Creating extra output files: BED GFF CSV TXT HTML
[20:51:26] Identified 5 variants.
[20:51:26] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297089
[20:51:26] Result files:
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.aligned.fa
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.bam
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.bam.bai
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.bed
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.consensus.fa
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.consensus.subs.fa
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.csv
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.filt.vcf
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.gff
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.html
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.log
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.raw.vcf
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.subs.vcf
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.tab
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.txt
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.vcf
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.vcf.gz
[20:51:26] * /mnt/scratch/c1803625/snippy/snip_SRR13297089/snps.vcf.gz.csi
[20:51:26] Walltime used: 18 seconds
[20:51:26] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[20:51:26] Done.
[20:51:26] This is snippy 4.6.0
[20:51:26] Written by Torsten Seemann
[20:51:26] Obtained from https://github.com/tseemann/snippy
[20:51:26] Detected operating system: linux
[20:51:26] Enabling bundled linux tools.
[20:51:26] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:51:26] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:51:26] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:51:26] Found java - /usr/bin/java
[20:51:26] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:51:26] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:51:26] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:51:26] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:51:26] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:51:26] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:51:26] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:51:26] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:51:27] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:51:27] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:51:27] Found gzip - /usr/bin/gzip
[20:51:27] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:51:27] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:51:27] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:51:27] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:51:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:51:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:51:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:51:27] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:51:27] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:51:27] Treating reference as 'fasta' format.
[20:51:27] Will use 8 CPU cores.
[20:51:27] Using read file: /mnt/scratch/c1803625/trimming/SRR13297090_1_trim.fastq.gz
[20:51:27] Using read file: /mnt/scratch/c1803625/trimming/SRR13297090_2_trim.fastq.gz
[20:51:27] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297090
[20:51:27] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297090
[20:51:27] Creating reference folder: reference
[20:51:27] Extracting FASTA and GFF from reference.
[20:51:27] Wrote 1 sequences to ref.fa
[20:51:27] Wrote 0 features to ref.gff
[20:51:27] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:51:27] Using BAM RG (Read Group) ID: snip_SRR13297090
[20:51:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:51:27] Running: bwa index reference/ref.fa 2>> snps.log
[20:51:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:51:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:51:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:51:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:51:27] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297090\tSM:snip_SRR13297090' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297090_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297090_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 444236 sequences (57908051 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (2, 200927, 10, 10)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (70, 114, 172)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 376)
[M::mem_pestat] mean and std.dev: (127.50, 74.95)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 478)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (57, 936, 1638)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 4800)
[M::mem_pestat] mean and std.dev: (1060.80, 988.25)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 6381)
[M::mem_pestat] analyzing insert size distribution for orientation RR...
[M::mem_pestat] (25, 50, 75) percentile: (535, 2045, 3008)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 7954)
[M::mem_pestat] mean and std.dev: (1837.00, 1588.11)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 10427)
[M::mem_pestat] skip orientation RF
[M::mem_pestat] skip orientation RR
[M::mem_process_seqs] Processed 444236 reads in 32.682 CPU sec, 4.196 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297090\tSM:snip_SRR13297090 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297090_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297090_2_trim.fastq.gz[samclip] Total SAM records 444862, removed 51395, allowed 2438, passed 393467
[samclip] Header contained 3 lines

[main] Real time: 7.509 sec; CPU: 34.236 sec
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:51:38] Running: samtools index snps.bam 2>> snps.log
[20:51:38] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:51:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:51:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 6
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:51:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:51:41] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:51:41] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:51:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:51:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:51:42] Running: bcftools consensus --sample snip_SRR13297090 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:51:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:51:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:51:42] Running: bcftools consensus --sample snip_SRR13297090 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:51:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:51:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:51:43] Marked 81 heterozygous sites with 'n'
[20:51:43] Creating extra output files: BED GFF CSV TXT HTML
[20:51:43] Identified 6 variants.
[20:51:43] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297090
[20:51:43] Result files:
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.aligned.fa
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.bam
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.bam.bai
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.bed
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.consensus.fa
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.consensus.subs.fa
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.csv
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.filt.vcf
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.gff
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.html
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.log
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.raw.vcf
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.subs.vcf
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.tab
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.txt
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.vcf
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.vcf.gz
[20:51:43] * /mnt/scratch/c1803625/snippy/snip_SRR13297090/snps.vcf.gz.csi
[20:51:43] Walltime used: 17 seconds
[20:51:43] May the SNPs be with you.
[20:51:43] Done.
[20:51:43] This is snippy 4.6.0
[20:51:43] Written by Torsten Seemann
[20:51:43] Obtained from https://github.com/tseemann/snippy
[20:51:43] Detected operating system: linux
[20:51:43] Enabling bundled linux tools.
[20:51:43] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:51:43] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:51:43] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:51:43] Found java - /usr/bin/java
[20:51:43] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:51:43] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:51:43] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:51:43] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:51:43] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:51:43] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:51:43] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:51:43] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:51:43] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:51:43] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:51:43] Found gzip - /usr/bin/gzip
[20:51:43] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:51:43] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:51:43] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:51:43] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:51:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:51:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:51:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:51:44] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:51:44] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:51:44] Treating reference as 'fasta' format.
[20:51:44] Will use 8 CPU cores.
[20:51:44] Using read file: /mnt/scratch/c1803625/trimming/SRR13297091_1_trim.fastq.gz
[20:51:44] Using read file: /mnt/scratch/c1803625/trimming/SRR13297091_2_trim.fastq.gz
[20:51:44] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297091
[20:51:44] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297091
[20:51:44] Creating reference folder: reference
[20:51:44] Extracting FASTA and GFF from reference.
[20:51:44] Wrote 1 sequences to ref.fa
[20:51:44] Wrote 0 features to ref.gff
[20:51:44] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:51:44] Using BAM RG (Read Group) ID: snip_SRR13297091
[20:51:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:51:44] Running: bwa index reference/ref.fa 2>> snps.log
[20:51:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:51:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:51:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:51:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:51:44] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297091\tSM:snip_SRR13297091' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297091_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297091_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 284576 sequences (39163233 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (1, 136285, 7, 6)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (75, 122, 184)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 402)
[M::mem_pestat] mean and std.dev: (136.46, 78.09)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 511)
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 284576 reads in 21.521 CPU sec, 2.770 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297091\tSM:snip_SRR13297091 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297091_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297091_2_trim.fastq.gz
[main] Real time: 4.952 sec; CPU: 22.600 sec
[samclip] Total SAM records 285169, removed 25186, allowed 1942, passed 259983
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:51:51] Running: samtools index snps.bam 2>> snps.log
[20:51:51] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:51:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:51:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:51:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:51:54] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:51:54] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:51:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:51:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:51:54] Running: bcftools consensus --sample snip_SRR13297091 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:51:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:51:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:51:54] Running: bcftools consensus --sample snip_SRR13297091 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:51:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:51:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:51:55] Marked 88 heterozygous sites with 'n'
[20:51:55] Creating extra output files: BED GFF CSV TXT HTML
[20:51:55] Identified 13 variants.
[20:51:55] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297091
[20:51:55] Result files:
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.aligned.fa
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.bam
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.bam.bai
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.bed
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.consensus.fa
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.consensus.subs.fa
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.csv
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.filt.vcf
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.gff
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.html
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.log
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.raw.vcf
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.subs.vcf
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.tab
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.txt
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.vcf
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.vcf.gz
[20:51:55] * /mnt/scratch/c1803625/snippy/snip_SRR13297091/snps.vcf.gz.csi
[20:51:55] Walltime used: 12 seconds
[20:51:55] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[20:51:55] Done.
[20:51:55] This is snippy 4.6.0
[20:51:55] Written by Torsten Seemann
[20:51:55] Obtained from https://github.com/tseemann/snippy
[20:51:55] Detected operating system: linux
[20:51:55] Enabling bundled linux tools.
[20:51:55] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:51:55] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:51:55] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:51:55] Found java - /usr/bin/java
[20:51:55] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:51:55] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:51:55] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:51:55] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:51:55] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:51:55] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:51:55] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:51:55] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:51:55] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:51:55] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:51:55] Found gzip - /usr/bin/gzip
[20:51:55] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:51:55] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:51:55] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:51:55] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:51:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:51:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:51:56] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:51:56] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:51:56] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:51:56] Treating reference as 'fasta' format.
[20:51:56] Will use 8 CPU cores.
[20:51:56] Using read file: /mnt/scratch/c1803625/trimming/SRR13297092_1_trim.fastq.gz
[20:51:56] Using read file: /mnt/scratch/c1803625/trimming/SRR13297092_2_trim.fastq.gz
[20:51:56] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297092
[20:51:56] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297092
[20:51:56] Creating reference folder: reference
[20:51:56] Extracting FASTA and GFF from reference.
[20:51:56] Wrote 1 sequences to ref.fa
[20:51:56] Wrote 0 features to ref.gff
[20:51:56] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:51:56] Using BAM RG (Read Group) ID: snip_SRR13297092
[20:51:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:51:56] Running: bwa index reference/ref.fa 2>> snps.log
[20:51:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:51:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:51:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:51:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:51:56] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297092\tSM:snip_SRR13297092' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297092_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297092_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 567110 sequences (80000275 bp)...
[M::process] read 27988 sequences (4009996 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (9, 272847, 19, 9)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (81, 126, 187)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 399)
[M::mem_pestat] mean and std.dev: (140.39, 76.94)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 505)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (831, 1833, 5471)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 14751)
[M::mem_pestat] mean and std.dev: (2853.68, 2684.69)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 19391)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 567110 reads in 44.649 CPU sec, 5.733 real sec
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 13520, 0, 0)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (83, 127, 189)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 401)
[M::mem_pestat] mean and std.dev: (141.98, 77.03)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 507)
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 27988 reads in 2.210 CPU sec, 0.304 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297092\tSM:snip_SRR13297092 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297092_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297092_2_trim.fastq.gz
[main] Real time: 10.445 sec; CPU: 49.075 sec
[samclip] Total SAM records 597210, removed 35143, allowed 5686, passed 562067
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:52:12] Running: samtools index snps.bam 2>> snps.log
[20:52:12] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:52:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:52:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 9
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:52:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:52:17] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:52:17] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:52:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:52:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:52:17] Running: bcftools consensus --sample snip_SRR13297092 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:52:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:52:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:52:17] Running: bcftools consensus --sample snip_SRR13297092 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:52:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:52:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:52:20] Marked 31 heterozygous sites with 'n'
[20:52:20] Creating extra output files: BED GFF CSV TXT HTML
[20:52:20] Identified 9 variants.
[20:52:20] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297092
[20:52:20] Result files:
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.aligned.fa
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.bam
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.bam.bai
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.bed
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.consensus.fa
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.consensus.subs.fa
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.csv
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.filt.vcf
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.gff
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.html
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.log
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.raw.vcf
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.subs.vcf
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.tab
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.txt
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.vcf
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.vcf.gz
[20:52:20] * /mnt/scratch/c1803625/snippy/snip_SRR13297092/snps.vcf.gz.csi
[20:52:20] Walltime used: 25 seconds
[20:52:20] Wishing you a life free of homopolymer errors.
[20:52:20] Done.
[20:52:20] This is snippy 4.6.0
[20:52:20] Written by Torsten Seemann
[20:52:20] Obtained from https://github.com/tseemann/snippy
[20:52:20] Detected operating system: linux
[20:52:20] Enabling bundled linux tools.
[20:52:20] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:52:20] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:52:20] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:52:20] Found java - /usr/bin/java
[20:52:20] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:52:20] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:52:20] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:52:20] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:52:20] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:52:20] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:52:20] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:52:20] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:52:20] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:52:20] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:52:20] Found gzip - /usr/bin/gzip
[20:52:20] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:52:20] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:52:20] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:52:20] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:52:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:52:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:52:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:52:20] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:52:20] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:52:20] Treating reference as 'fasta' format.
[20:52:20] Will use 8 CPU cores.
[20:52:20] Using read file: /mnt/scratch/c1803625/trimming/SRR13297093_1_trim.fastq.gz
[20:52:20] Using read file: /mnt/scratch/c1803625/trimming/SRR13297093_2_trim.fastq.gz
[20:52:20] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297093
[20:52:20] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297093
[20:52:20] Creating reference folder: reference
[20:52:20] Extracting FASTA and GFF from reference.
[20:52:20] Wrote 1 sequences to ref.fa
[20:52:20] Wrote 0 features to ref.gff
[20:52:20] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:52:20] Using BAM RG (Read Group) ID: snip_SRR13297093
[20:52:20] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:52:21] Running: bwa index reference/ref.fa 2>> snps.log
[20:52:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:52:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:52:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:52:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:52:21] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297093\tSM:snip_SRR13297093' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297093_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297093_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 573306 sequences (80000284 bp)...
[M::process] read 75590 sequences (10645675 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (7, 275332, 30, 9)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (79, 125, 185)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 397)
[M::mem_pestat] mean and std.dev: (138.87, 77.06)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 503)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (309, 598, 5508)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 15906)
[M::mem_pestat] mean and std.dev: (2247.70, 2596.74)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 21105)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 573306 reads in 44.547 CPU sec, 5.725 real sec
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (0, 36323, 3, 1)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (81, 126, 186)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 396)
[M::mem_pestat] mean and std.dev: (139.82, 77.10)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 501)
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 75590 reads in 5.751 CPU sec, 0.783 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[samclip] Processed 600000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297093\tSM:snip_SRR13297093 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297093_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297093_2_trim.fastq.gz
[main] Real time: 10.943 sec; CPU: 52.557 sec
[samclip] Total SAM records 650947, removed 44678, allowed 5849, passed 606269
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:52:37] Running: samtools index snps.bam 2>> snps.log
[20:52:37] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:52:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:52:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 6
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:52:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:52:43] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:52:43] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:52:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:52:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:52:43] Running: bcftools consensus --sample snip_SRR13297093 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:52:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:52:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:52:43] Running: bcftools consensus --sample snip_SRR13297093 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:52:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:52:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:52:46] Marked 62 heterozygous sites with 'n'
[20:52:46] Creating extra output files: BED GFF CSV TXT HTML
[20:52:46] Identified 6 variants.
[20:52:46] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297093
[20:52:46] Result files:
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.aligned.fa
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.bam
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.bam.bai
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.bed
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.consensus.fa
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.consensus.subs.fa
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.csv
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.filt.vcf
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.gff
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.html
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.log
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.raw.vcf
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.subs.vcf
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.tab
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.txt
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.vcf
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.vcf.gz
[20:52:46] * /mnt/scratch/c1803625/snippy/snip_SRR13297093/snps.vcf.gz.csi
[20:52:46] Walltime used: 26 seconds
[20:52:46] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[20:52:46] Done.
[20:52:46] This is snippy 4.6.0
[20:52:46] Written by Torsten Seemann
[20:52:46] Obtained from https://github.com/tseemann/snippy
[20:52:46] Detected operating system: linux
[20:52:46] Enabling bundled linux tools.
[20:52:46] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:52:46] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:52:46] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:52:46] Found java - /usr/bin/java
[20:52:46] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:52:46] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:52:46] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:52:46] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:52:46] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:52:46] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:52:46] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:52:46] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:52:46] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:52:46] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:52:46] Found gzip - /usr/bin/gzip
[20:52:46] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:52:46] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:52:46] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:52:46] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:52:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:52:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:52:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:52:47] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:52:47] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:52:47] Treating reference as 'fasta' format.
[20:52:47] Will use 8 CPU cores.
[20:52:47] Using read file: /mnt/scratch/c1803625/trimming/SRR13297094_1_trim.fastq.gz
[20:52:47] Using read file: /mnt/scratch/c1803625/trimming/SRR13297094_2_trim.fastq.gz
[20:52:47] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297094
[20:52:47] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297094
[20:52:47] Creating reference folder: reference
[20:52:47] Extracting FASTA and GFF from reference.
[20:52:47] Wrote 1 sequences to ref.fa
[20:52:47] Wrote 0 features to ref.gff
[20:52:47] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:52:47] Using BAM RG (Read Group) ID: snip_SRR13297094
[20:52:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:52:47] Running: bwa index reference/ref.fa 2>> snps.log
[20:52:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:52:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:52:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:52:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:52:47] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297094\tSM:snip_SRR13297094' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297094_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297094_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 551868 sequences (80000128 bp)...
[M::process] read 88150 sequences (12935628 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (7, 270547, 14, 4)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (84, 131, 192)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 408)
[M::mem_pestat] mean and std.dev: (144.86, 76.67)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 516)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (1039, 1552, 4727)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 12103)
[M::mem_pestat] mean and std.dev: (2832.14, 2316.63)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 15791)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 551868 reads in 41.628 CPU sec, 5.359 real sec
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (1, 43257, 4, 1)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (86, 133, 194)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 410)
[M::mem_pestat] mean and std.dev: (146.61, 76.39)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 518)
[M::mem_pestat] skip orientation RF as there are not enough pairs
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_process_seqs] Processed 88150 reads in 6.496 CPU sec, 0.912 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[samclip] Processed 600000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297094\tSM:snip_SRR13297094 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297094_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297094_2_trim.fastq.gz
[main] Real time: 10.289 sec; CPU: 50.322 sec
[samclip] Total SAM records 641536, removed 8058, allowed 4485, passed 633478
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:53:03] Running: samtools index snps.bam 2>> snps.log
[20:53:03] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:53:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:53:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 10
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:53:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:53:08] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:53:08] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:53:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:53:08] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:53:08] Running: bcftools consensus --sample snip_SRR13297094 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:53:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:53:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:53:08] Running: bcftools consensus --sample snip_SRR13297094 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:53:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:53:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:53:11] Marked 101 heterozygous sites with 'n'
[20:53:11] Creating extra output files: BED GFF CSV TXT HTML
[20:53:11] Identified 10 variants.
[20:53:11] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297094
[20:53:11] Result files:
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.aligned.fa
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.bam
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.bam.bai
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.bed
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.consensus.fa
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.consensus.subs.fa
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.csv
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.filt.vcf
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.gff
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.html
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.log
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.raw.vcf
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.subs.vcf
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.tab
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.txt
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.vcf
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.vcf.gz
[20:53:11] * /mnt/scratch/c1803625/snippy/snip_SRR13297094/snps.vcf.gz.csi
[20:53:11] Walltime used: 25 seconds
[20:53:11] Wishing you a life free of homopolymer errors.
[20:53:11] Done.
[20:53:11] This is snippy 4.6.0
[20:53:11] Written by Torsten Seemann
[20:53:11] Obtained from https://github.com/tseemann/snippy
[20:53:11] Detected operating system: linux
[20:53:11] Enabling bundled linux tools.
[20:53:11] Found bwa - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bwa
[20:53:11] Found bcftools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bcftools
[20:53:11] Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
[20:53:11] Found java - /usr/bin/java
[20:53:11] Found snpEff - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/snpEff
[20:53:11] Found samclip - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/samclip
[20:53:11] Found seqtk - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/seqtk
[20:53:11] Found parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/parallel
[20:53:11] Found freebayes - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/freebayes
[20:53:11] Found freebayes-parallel - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/freebayes-parallel
[20:53:11] Found fasta_generate_regions.py - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/fasta_generate_regions.py
[20:53:11] Found vcfstreamsort - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfstreamsort
[20:53:11] Found vcfuniq - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vcfuniq
[20:53:11] Found vcffirstheader - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/vcffirstheader
[20:53:11] Found gzip - /usr/bin/gzip
[20:53:11] Found vt - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/vt
[20:53:11] Found snippy-vcf_to_tab - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab
[20:53:11] Found snippy-vcf_report - /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_report
[20:53:11] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[20:53:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[20:53:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[20:53:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[20:53:11] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[20:53:11] Using reference: /mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta
[20:53:11] Treating reference as 'fasta' format.
[20:53:11] Will use 8 CPU cores.
[20:53:11] Using read file: /mnt/scratch/c1803625/trimming/SRR13297095_1_trim.fastq.gz
[20:53:11] Using read file: /mnt/scratch/c1803625/trimming/SRR13297095_2_trim.fastq.gz
[20:53:11] Creating folder: /mnt/scratch/c1803625/snippy/snip_SRR13297095
[20:53:12] Changing working directory: /mnt/scratch/c1803625/snippy/snip_SRR13297095
[20:53:12] Creating reference folder: reference
[20:53:12] Extracting FASTA and GFF from reference.
[20:53:12] Wrote 1 sequences to ref.fa
[20:53:12] Wrote 0 features to ref.gff
[20:53:12] Freebayes will process 15 chunks of 2027 bp, 8 chunks at a time.
[20:53:12] Using BAM RG (Read Group) ID: snip_SRR13297095
[20:53:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[20:53:12] Running: bwa index reference/ref.fa 2>> snps.log
[20:53:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[20:53:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[20:53:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[20:53:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[20:53:12] Running: bwa mem  -Y -M -R '@RG\tID:snip_SRR13297095\tSM:snip_SRR13297095' -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297095_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297095_2_trim.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 3 -m 2000M | samtools fixmate -m --threads 3 - - | samtools sort -l 0 -T /tmp --threads 3 -m 2000M | samtools markdup -T /tmp --threads 3 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 414196 sequences (58450831 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (6, 196552, 19, 5)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (81, 127, 188)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 402)
[M::mem_pestat] mean and std.dev: (141.10, 77.62)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 509)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (304, 1534, 5512)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 15928)
[M::mem_pestat] mean and std.dev: (2855.47, 2631.31)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 21136)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 414196 reads in 32.625 CPU sec, 4.190 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:snip_SRR13297095\tSM:snip_SRR13297095 -t 8 reference/ref.fa /mnt/scratch/c1803625/trimming/SRR13297095_1_trim.fastq.gz /mnt/scratch/c1803625/trimming/SRR13297095_2_trim.fastq.gz
[main] Real time: 7.791 sec; CPU: 34.445 sec
[samclip] Total SAM records 415652, removed 32141, allowed 4125, passed 383511
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
[20:53:23] Running: samtools index snps.bam 2>> snps.log
[20:53:23] Running: fasta_generate_regions.py reference/ref.fa.fai 2027 > reference/ref.txt 2>> snps.log
[20:53:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[20:53:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 5
       total no. reference observed             : 0

Time elapsed: 0.00s

[20:53:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[20:53:27] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[20:53:27] Running: /trinity/shared/apps/site-local/snippy/v4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[20:53:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[20:53:27] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[20:53:27] Running: bcftools consensus --sample snip_SRR13297095 -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[20:53:27] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[20:53:27] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[20:53:28] Running: bcftools consensus --sample snip_SRR13297095 -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[20:53:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[20:53:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[20:53:29] Marked 42 heterozygous sites with 'n'
[20:53:29] Creating extra output files: BED GFF CSV TXT HTML
[20:53:29] Identified 5 variants.
[20:53:29] Result folder: /mnt/scratch/c1803625/snippy/snip_SRR13297095
[20:53:29] Result files:
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.aligned.fa
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.bam
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.bam.bai
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.bed
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.consensus.fa
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.consensus.subs.fa
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.csv
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.filt.vcf
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.gff
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.html
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.log
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.raw.vcf
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.subs.vcf
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.tab
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.txt
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.vcf
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.vcf.gz
[20:53:29] * /mnt/scratch/c1803625/snippy/snip_SRR13297095/snps.vcf.gz.csi
[20:53:29] Walltime used: 18 seconds
[20:53:29] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[20:53:29] Done.
This is snippy-core 4.6.0
Obtained from http://github.com/tseemann/snippy
Enabling bundled tools for linux
Found any2fasta - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/noarch/any2fasta
Found samtools - /trinity/shared/apps/site-local/samtools/1.10/bin/samtools
Found minimap2 - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/minimap2
Found bedtools - /trinity/shared/apps/site-local/snippy/v4.6.0/binaries/linux/bedtools
Found snp-sites - /trinity/shared/apps/site-local/snp-sites/2.5.1/bin/snp-sites
Saving reference FASTA: /mnt/scratch/c1803625/snippy/output-alignment.ref.fa
This is any2fasta 0.4.2
Opening '/mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta'
Detected FASTA format
Read 2 lines from '/mnt/scratch/c1803625/fishing/NC_045512_DNA.fasta'
Wrote 1 sequences from FASTA file.
Processed 1 files.
Done.
Loaded 1 sequences totalling 29903 bp.
Will mask 0 regions totalling 0 bp ~ 0.00%
0	snip_SRR13297086	snp=6	del=0	ins=0	het=44	unaligned=90
1	snip_SRR13297087	snp=10	del=0	ins=0	het=63	unaligned=211
2	snip_SRR13297088	snp=10	del=0	ins=0	het=49	unaligned=368
3	snip_SRR13297089	snp=5	del=0	ins=0	het=35	unaligned=583
4	snip_SRR13297090	snp=6	del=0	ins=0	het=81	unaligned=358
5	snip_SRR13297091	snp=13	del=0	ins=0	het=88	unaligned=203
6	snip_SRR13297092	snp=9	del=0	ins=0	het=31	unaligned=1482
7	snip_SRR13297093	snp=6	del=0	ins=0	het=62	unaligned=608
8	snip_SRR13297094	snp=10	del=0	ins=0	het=101	unaligned=359
9	snip_SRR13297095	snp=5	del=0	ins=0	het=42	unaligned=387
Opening: /mnt/scratch/c1803625/snippy/output-alignment.tab
Opening: /mnt/scratch/c1803625/snippy/output-alignment.vcf
Processing contig: NC_045512
Generating /mnt/scratch/c1803625/snippy/output-alignment.full.aln
Creating TSV file: /mnt/scratch/c1803625/snippy/output-alignment.txt
Running: snp-sites -c -o /mnt/scratch/c1803625/snippy/output-alignment.aln /mnt/scratch/c1803625/snippy/output-alignment.full.aln
The Snippy manual is at http://github.com/tseemann/snippy/blob/master/README.md
Done.
FastTree Version 2.1.11 SSE3, OpenMP (8 threads)
Alignment: standard input
Nucleotide distances: Jukes-Cantor Joins: balanced Support: SH-like 1000
Search: Normal +NNI +SPR (2 rounds range 10) +ML-NNI opt-each=1
TopHits: 1.00*sqrtN close=default refresh=0.80
ML Model: Generalized Time-Reversible, CAT approximation with 20 rate categories
Initial topology in 0.00 seconds
Refining topology: 11 rounds ME-NNIs, 2 rounds ME-SPRs, 6 rounds ML-NNIs
Total branch-length 1.461 after 0.00 sec
ML-NNI round 1: LogLk = -80.382 NNIs 2 max delta 0.00 Time 0.00
GTR Frequencies: 0.1293 0.4138 0.1207 0.3362
GTR rates(ac ag at cg ct gt) 1.0000 137.0605 13.9070 1.0000 66.7068 1.0000
Switched to using 20 rate categories (CAT approximation)
Rate categories were divided by 0.782 so that average rate = 1.0
CAT-based log-likelihoods may not be comparable across runs
Use -gamma for approximate but comparable Gamma(20) log-likelihoods
ML-NNI round 2: LogLk = -63.309 NNIs 1 max delta 0.00 Time 0.01
Turning off heuristics for final round of ML NNIs (converged)
ML-NNI round 3: LogLk = -63.309 NNIs 0 max delta 0.00 Time 0.01 (final)
Optimize all lengths: LogLk = -63.309 Time 0.01
Total time: 0.01 seconds Unique: 7/11 Bad splits: 0/4
